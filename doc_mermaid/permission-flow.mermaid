graph TD;
    A["User selects Photos/Videos tab"] --> B["Check if permission granted"]
    B -->|"Yes"| C["Load media"]
    B -->|"No"| D["Request permission"]
    D -->|"Granted"| C
    D -->|"Denied"| E["Show rationale dialog"]
    E -->|"Try Again"| D
    E -->|"Cancel"| F["Stay on current screen"]
    D -->|"Permanently Denied"| G["Show settings dialog"]
    G -->|"Settings"| H["Open app settings"]
    G -->|"Cancel"| F
    H --> I["User grants permission in settings"]
    I -->|"Return to app"| B